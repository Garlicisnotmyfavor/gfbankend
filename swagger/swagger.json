{
    "swagger": "2.0",
    "info": {
        "title": "beego Test API",
        "description": "beego has a very cool tools to autogenerate documents for your API",
        "version": "1.0.0",
        "termsOfService": "http://beego.me/",
        "contact": {
            "email": "astaxie@gmail.com"
        },
        "license": {
            "name": "Apache 2.0",
            "url": "http://www.apache.org/licenses/LICENSE-2.0.html"
        }
    },
    "basePath": "/v1",
    "paths": {
        "/api/user/card/add": {
            "post": {
                "tags": [
                    "api/user"
                ],
                "description": "将这个user的id和卡绑定,由cookie获取sessionid从而得到当前用户ID",
                "operationId": "CardController.AddCard",
                "parameters": [
                    {
                        "in": "body",
                        "name": "id",
                        "description": "原本的卡号cardid+企业enterprise",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions//"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "返回绑定的卡的大致信息",
                        "schema": {
                            "$ref": "#/definitions/models.Card"
                        }
                    },
                    "400": {
                        "description": "解析错误"
                    },
                    "401": {
                        "description": "没处于登录状态，无权限"
                    },
                    "402": {
                        "description": "数据不匹配"
                    },
                    "403": {
                        "description": "绑定的卡片不存在"
                    }
                }
            }
        },
        "/api/user/card/get": {
            "put": {
                "tags": [
                    "api/user"
                ],
                "description": "领取新的卡片",
                "operationId": "CardController.getCard",
                "parameters": [
                    {
                        "in": "body",
                        "name": "card_id",
                        "description": "卡号",
                        "required": true,
                        "schema": {
                            "type": "string"
                        },
                        "type": "string"
                    },
                    {
                        "in": "body",
                        "name": "enterprise",
                        "description": "企业名称",
                        "required": true,
                        "schema": {
                            "type": "string"
                        },
                        "type": "string"
                    },
                    {
                        "in": "body",
                        "name": "card_type",
                        "description": "类型",
                        "required": true,
                        "schema": {
                            "type": "string"
                        },
                        "type": "string"
                    }
                ],
                "responses": {
                    "200": {
                        "description": ""
                    },
                    "400": {
                        "description": "解析Json出错"
                    },
                    "401": {
                        "description": "没处于登录状态，无权限"
                    },
                    "403": {
                        "description": "卡片已经被其他用户领取"
                    },
                    "405": {
                        "description": "数据库更新失败"
                    }
                }
            }
        },
        "/api/user/card/getnewcard": {
            "post": {
                "tags": [
                    "api/user"
                ],
                "operationId": "CardController.获取虚拟卡片",
                "parameters": [
                    {
                        "in": "query",
                        "name": "id",
                        "description": "卡号",
                        "required": true,
                        "type": "string"
                    }
                ],
                "responses": {
                    "": {
                        "description": ""
                    },
                    "200": {
                        "description": ""
                    }
                }
            }
        },
        "/api/user/card/{id\t[get]}": {
            "get": {
                "tags": [
                    "api/user"
                ],
                "description": "将这张卡片的所有信息传出去",
                "operationId": "CardController.GetCardIDInfo",
                "parameters": [
                    {
                        "in": "path",
                        "name": "id",
                        "description": "查询的卡号",
                        "required": true,
                        "type": "string"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "查询成功"
                    },
                    "400": {
                        "description": "查询不到对应的卡"
                    },
                    "401": {
                        "description": "没处于登录状态，无权限"
                    },
                    "404": {
                        "description": "查询不到对应的公司"
                    }
                }
            }
        },
        "/api/user/card/{id}/cardLog": {
            "get": {
                "tags": [
                    "api/user"
                ],
                "operationId": "CardController.查看卡片使用记录",
                "parameters": [
                    {
                        "in": "query",
                        "name": "id",
                        "description": "卡号",
                        "required": true,
                        "type": "string"
                    }
                ],
                "responses": {
                    "200": {
                        "description": ""
                    },
                    "400": {
                        "description": "解析Json失败"
                    },
                    "401": {
                        "description": "没有登录"
                    },
                    "404": {
                        "description": "卡不存在"
                    }
                }
            }
        },
        "/api/user/card/{id}/coupons": {
            "post": {
                "tags": [
                    "api/user"
                ],
                "description": "增加或减少某张卡的某种优惠券",
                "operationId": "CardController.coupons",
                "parameters": [
                    {
                        "in": "path",
                        "name": "id",
                        "description": "卡号",
                        "required": true,
                        "type": "string"
                    },
                    {
                        "in": "body",
                        "name": "Increment",
                        "description": "优惠券改变的数量，可以为负数",
                        "required": true,
                        "schema": {
                            "format": "int64",
                            "type": "integer"
                        },
                        "type": "integer",
                        "format": "int64"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "成功"
                    },
                    "400": {
                        "description": "json解析错误"
                    },
                    "401": {
                        "description": "没处于登录状态，无权限"
                    },
                    "403": {
                        "description": "优惠券不足"
                    },
                    "404": {
                        "description": "卡不存在"
                    },
                    "406": {
                        "description": "非法数据"
                    }
                }
            }
        },
        "/api/user/card/{id}/delete": {
            "post": {
                "tags": [
                    "api/user"
                ],
                "description": "删除卡片",
                "operationId": "CardController.delete",
                "parameters": [
                    {
                        "in": "path",
                        "name": "id",
                        "description": "卡号",
                        "required": true,
                        "type": "string"
                    }
                ],
                "responses": {
                    "200": {
                        "description": ""
                    },
                    "400": {
                        "description": "json解析错误"
                    },
                    "401": {
                        "description": "没登录，无权限"
                    },
                    "403": {
                        "description": "用户ID不存在"
                    },
                    "404": {
                        "description": "卡不存在"
                    }
                }
            }
        },
        "/api/user/card/{id}/info": {
            "put": {
                "tags": [
                    "api/user"
                ],
                "description": "修改卡片的卡号，公司",
                "operationId": "CardController.ModifyCardInfo",
                "parameters": [
                    {
                        "in": "path",
                        "name": "id",
                        "description": "原本的卡号",
                        "required": true,
                        "type": "string"
                    },
                    {
                        "in": "body",
                        "name": "cardInfo",
                        "description": "CardId(string)+Enterprise(string)",
                        "schema": {
                            "$ref": "#/definitions//"
                        },
                        "default": "true"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "修改成功，返回新卡片对象",
                        "schema": {
                            "$ref": "#/definitions/models.Card"
                        }
                    },
                    "400": {
                        "description": "body解析错误"
                    },
                    "401": {
                        "description": "没处于登录状态，无权限"
                    },
                    "403": {
                        "description": "卡号解析错误"
                    },
                    "404": {
                        "description": "卡片信息读取错误"
                    },
                    "500": {
                        "description": "数据库更新操作错误"
                    }
                }
            }
        },
        "/api/user/card/{id}/score": {
            "put": {
                "tags": [
                    "api/user"
                ],
                "description": "操作卡片的积分",
                "operationId": "CardController.UseScore",
                "parameters": [
                    {
                        "in": "body",
                        "name": "id",
                        "description": "CardId(string)+increment(int)",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions//"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "修改成功，返回新卡片对象",
                        "schema": {
                            "$ref": "#/definitions/models.Card"
                        }
                    },
                    "400": {
                        "description": "body解析错误"
                    },
                    "401": {
                        "description": "没处于登录状态，无权限"
                    },
                    "406": {
                        "description": "积分信息有误"
                    },
                    "500": {
                        "description": "数据库更新操作错误"
                    }
                }
            }
        },
        "/api/user/enroll": {
            "post": {
                "tags": [
                    "api/user"
                ],
                "description": "user register",
                "operationId": "UserController.Register",
                "parameters": [
                    {
                        "in": "body",
                        "name": "userInfo",
                        "description": "电话tel+邮箱mail+密码password+验证码verify",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/\\"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "返回值：结构体其中有msg信息，数据data"
                    },
                    "400": {
                        "description": "解析json出错，返回值：具体错误信息{\"msg\":xxx}"
                    },
                    "403": {
                        "description": "插入数据库错误，返回值：错误信息{\"msg\":xxx}"
                    },
                    "406": {
                        "description": "信息有误，详见返回值：错误信息{\"msg\":xxx}"
                    }
                }
            }
        },
        "/api/user/enterprise/activity": {
            "get": {
                "tags": [
                    "api/user"
                ],
                "description": "查看所有优惠活动",
                "operationId": "UserController.readAllActivities",
                "responses": {
                    "200": {
                        "description": "请求成功，返回所以活动"
                    },
                    "503": {
                        "description": "读取数据库出错(可能服务器端数据库出错)"
                    }
                }
            },
            "put": {
                "tags": [
                    "api/user"
                ],
                "description": "查询活动",
                "operationId": "UserController.readActivity",
                "parameters": [
                    {
                        "in": "body",
                        "name": "enterprise",
                        "description": "企业名称",
                        "required": true,
                        "schema": {
                            "type": "string"
                        },
                        "type": "string"
                    },
                    {
                        "in": "body",
                        "name": "card_type",
                        "description": "卡片类型",
                        "required": true,
                        "schema": {
                            "type": "string"
                        },
                        "type": "string"
                    }
                ],
                "responses": {
                    "200": {
                        "description": ""
                    },
                    "400": {
                        "description": "请求格式出错"
                    },
                    "503": {
                        "description": "读取数据库发生错误（服务器端可能有问题）"
                    }
                }
            }
        },
        "/api/user/enterprise/card": {
            "put": {
                "tags": [
                    "api/user"
                ],
                "description": "发布新的卡片",
                "operationId": "UserController.put New Card",
                "parameters": [
                    {
                        "in": "body",
                        "name": "cardDemo",
                        "description": "卡片基本信息",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/models.CardDemo"
                        }
                    },
                    {
                        "in": "body",
                        "name": "backgroundBase64",
                        "description": "Base64Code",
                        "required": true,
                        "schema": {
                            "type": "string"
                        },
                        "type": "string"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "put successfully"
                    },
                    "400": {
                        "description": "解析body失败"
                    },
                    "405": {
                        "description": "插入数据失败"
                    }
                }
            }
        },
        "/api/user/enterprise/enroll": {
            "post": {
                "tags": [
                    "api/user"
                ],
                "description": "商家注册",
                "operationId": "UserController.Register",
                "parameters": [
                    {
                        "in": "body",
                        "name": "EnterPriseInfo",
                        "description": "注册信息(商家名称name+营业执照号码license_id+地址Addr+商家类型type+是否为本地is_local+管理人名称manager_name+管理人身份证manager_id+手机号码phone+密码password",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/models.Enterprise"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "\"OK\"",
                        "schema": {
                            "$ref": "#/definitions/models.Enterprise"
                        }
                    },
                    "400": {
                        "description": "信息有误"
                    },
                    "406": {
                        "description": "数据库加入错误"
                    }
                }
            }
        },
        "/api/user/enterprise/login": {
            "put": {
                "tags": [
                    "api/user"
                ],
                "description": "商家登陆",
                "operationId": "EnterpriseController.Login",
                "parameters": [
                    {
                        "in": "body",
                        "name": "enterpriseInfo",
                        "description": "account(string)+password(string)+remember(bool)",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions//"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Register successfully",
                        "schema": {
                            "$ref": "#/definitions/models.User"
                        }
                    },
                    "400": {
                        "description": "信息内容或格式有误"
                    },
                    "406": {
                        "description": "数据库查询报错，可能用户所填账号或密码错误"
                    }
                }
            }
        },
        "/api/user/enterprise/modifyInfo": {
            "put": {
                "tags": [
                    "api/user"
                ],
                "description": "修改注册的商家注册信息",
                "operationId": "UserController.enterprise information modify",
                "parameters": [
                    {
                        "in": "body",
                        "name": "enterpriseInfo",
                        "description": "重新提交的商家注册信息,body内部包含两个部分信息,一个为manager信息,一个为enterprise信息",
                        "schema": {
                            "$ref": "#/definitions//"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Update Successfully"
                    },
                    "400": {
                        "description": "解析body失败"
                    },
                    "404": {
                        "description": "数据库无此商铺"
                    },
                    "406": {
                        "description": "更新商铺信息失败"
                    },
                    "407": {
                        "description": "创建base64文件失败"
                    },
                    "408": {
                        "description": "关闭base64文件失败"
                    }
                }
            }
        },
        "/api/user/enterprise/password": {
            "put": {
                "tags": [
                    "api/user"
                ],
                "description": "change password",
                "operationId": "EnterpriseController.changePW",
                "parameters": [
                    {
                        "in": "body",
                        "name": "enterpriseInfo",
                        "description": "用户信息(需要的是用户ID,原密码,新密码）",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions//"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Update successfully"
                    },
                    "400": {
                        "description": "解析body失败"
                    },
                    "404": {
                        "description": "数据库无此用户"
                    },
                    "500": {
                        "description": "数据库更新密码失败"
                    }
                }
            }
        },
        "/api/user/enterprise/password/new": {
            "put": {
                "tags": [
                    "api/user"
                ],
                "description": "通过前面忘记密码的过程后，设置新的密码",
                "operationId": "UserController.NewPassword",
                "parameters": [
                    {
                        "in": "body",
                        "name": "enterpriseInfo",
                        "description": "用户信息(需要的是用户ID，新密码）",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/models.Enterprise"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Update successfully"
                    },
                    "400": {
                        "description": "解析body失败"
                    },
                    "404": {
                        "description": "数据库无此用户"
                    },
                    "406": {
                        "description": "更新密码失败"
                    }
                }
            }
        },
        "/api/user/enterprise/{id}": {
            "get": {
                "tags": [
                    "api/user"
                ],
                "description": "返回商家具体信息以及管理员信息 打包在一个json内，分别用enterprise和managerList两个key取得",
                "operationId": "UserController.return the enterprise information",
                "parameters": [
                    {
                        "in": "path",
                        "name": "enterpriseId",
                        "description": "商家ID",
                        "required": true,
                        "type": "string"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Return Successfully"
                    },
                    "400": {
                        "description": "解析body失败"
                    },
                    "404": {
                        "description": "读取管理员失败"
                    }
                }
            }
        },
        "/api/user/forgetPw": {
            "post": {
                "tags": [
                    "api/user"
                ],
                "description": "Forget password",
                "operationId": "UserController.ForgetPW",
                "parameters": [
                    {
                        "in": "body",
                        "name": "userInfo",
                        "description": "用户信息(需要的是用户ID，邮件）",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/models.User"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "successfully"
                    },
                    "400": {
                        "description": "解析body失败"
                    },
                    "404": {
                        "description": "数据库无此用户"
                    }
                }
            }
        },
        "/api/user/login": {
            "get": {
                "tags": [
                    "api/user"
                ],
                "description": "通过获取客户端的cookie来进行自动登录cookie在正常登录时选择自动登录后获得,失败则消除cookie",
                "operationId": "UserController.LoginWithCookie",
                "responses": {
                    "200": {
                        "description": "通过cookie完成了自动登录"
                    },
                    "204": {
                        "description": "cookie失效"
                    }
                }
            },
            "put": {
                "tags": [
                    "api/user"
                ],
                "description": "登录，返回中由名为bsessionID的cookie，用于查用户是否已登录如果点击了自动登录（即remember为true）还会返回名为account，password，accounttype以及remember的cookie",
                "operationId": "UserController.Login",
                "parameters": [
                    {
                        "in": "body",
                        "name": "userInfo",
                        "description": "account(string)+password(string)+accounttype(string)为mail或者phone+remember(是否记住密码bool)",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions//"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Register successfully",
                        "schema": {
                            "$ref": "#/definitions/models.User"
                        }
                    },
                    "400": {
                        "description": "信息内容或格式有误"
                    },
                    "406": {
                        "description": "数据库查询报错，可能用户所填账号或密码错误"
                    }
                }
            }
        },
        "/api/user/password": {
            "put": {
                "tags": [
                    "api/user"
                ],
                "description": "change password",
                "operationId": "UserController.changePW",
                "parameters": [
                    {
                        "in": "body",
                        "name": "userInfo",
                        "description": "用户信息(需要的是用户ID，原密码，新密码）",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions//"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Update successfully"
                    },
                    "400": {
                        "description": "解析body失败"
                    },
                    "401": {
                        "description": "没登录，无权限"
                    },
                    "403": {
                        "description": "数据库无此用户"
                    },
                    "404": {
                        "description": "数据库无此用户"
                    },
                    "406": {
                        "description": "更新密码失败"
                    }
                }
            }
        },
        "/api/user/verify": {
            "post": {
                "tags": [
                    "api/user"
                ],
                "description": "send random code",
                "operationId": "UserController.getRanCodeInRegister",
                "parameters": [
                    {
                        "in": "body",
                        "name": "email",
                        "description": "email:xxx",
                        "required": true,
                        "schema": {
                            "type": "string"
                        },
                        "type": "string"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "string\t\"生成的验证码\""
                    },
                    "400": {
                        "description": "解析body失败"
                    },
                    "500": {
                        "description": "发送邮件失败"
                    }
                }
            }
        },
        "/api/user/{id}": {
            "get": {
                "tags": [
                    "api/user"
                ],
                "description": "show all cards",
                "operationId": "UserController.showAllCards",
                "parameters": [
                    {
                        "in": "path",
                        "name": "userID",
                        "description": "用户ID",
                        "required": true,
                        "type": "string"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Read successfully"
                    },
                    "401": {
                        "description": "没登录，无权限"
                    },
                    "404": {
                        "description": "Fail to read"
                    }
                }
            }
        }
    },
    "definitions": {
        "/": {
            "title": "/",
            "type": "object"
        },
        "\\": {
            "title": "\\",
            "type": "object"
        },
        "models.Card": {
            "title": "Card",
            "type": "object",
            "properties": {
                "BatchNum": {
                    "type": "integer",
                    "format": "int64"
                },
                "CardId": {
                    "type": "string"
                },
                "CardOrder": {
                    "type": "integer",
                    "format": "int64"
                },
                "CardType": {
                    "type": "string"
                },
                "City": {
                    "type": "string"
                },
                "Coupons": {
                    "type": "string"
                },
                "CouponsNum": {
                    "type": "integer",
                    "format": "int64"
                },
                "DelTime": {
                    "type": "string",
                    "format": "datetime"
                },
                "Enterprise": {
                    "type": "string"
                },
                "ExpireTime": {
                    "type": "string",
                    "format": "datetime"
                },
                "FactoryNum": {
                    "type": "integer",
                    "format": "int64"
                },
                "Money": {
                    "type": "integer",
                    "format": "int64"
                },
                "Score": {
                    "type": "integer",
                    "format": "int64"
                },
                "SerialNum": {
                    "type": "integer",
                    "format": "int64"
                },
                "StartTime": {
                    "type": "string",
                    "format": "datetime"
                },
                "State": {
                    "type": "string"
                },
                "UserId": {
                    "type": "string"
                }
            }
        },
        "models.CardDemo": {
            "title": "CardDemo",
            "type": "object",
            "properties": {
                "CardType": {
                    "type": "string"
                },
                "City": {
                    "type": "string"
                },
                "Coupons": {
                    "type": "string"
                },
                "Describe": {
                    "type": "string"
                },
                "Enterprise": {
                    "type": "string"
                },
                "ExpireTime": {
                    "type": "string",
                    "format": "datetime"
                },
                "ID": {
                    "type": "integer",
                    "format": "int64"
                },
                "State": {
                    "type": "string"
                }
            }
        },
        "models.Enterprise": {
            "title": "Enterprise",
            "type": "object",
            "properties": {
                "Addr": {
                    "type": "string"
                },
                "HelpMsg": {
                    "type": "string"
                },
                "Id": {
                    "type": "string"
                },
                "IsLocal": {
                    "type": "boolean"
                },
                "LicenseId": {
                    "type": "string"
                },
                "Name": {
                    "type": "string"
                },
                "RegisterNum": {
                    "type": "integer",
                    "format": "int64"
                },
                "Type": {
                    "type": "string"
                },
                "Website": {
                    "type": "string"
                }
            }
        },
        "models.User": {
            "title": "User",
            "type": "object",
            "properties": {
                "Id": {
                    "type": "string"
                },
                "LoginMonth": {
                    "type": "string"
                },
                "LoginNum": {
                    "type": "integer",
                    "format": "int64"
                },
                "LoginYear": {
                    "type": "string"
                },
                "Mail": {
                    "type": "string"
                },
                "Password": {
                    "type": "string"
                },
                "Tel": {
                    "type": "string"
                }
            }
        }
    }
}